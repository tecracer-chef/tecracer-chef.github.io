<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Arm your GitHub Actions Runners using AWS Graviton | tecRacer Chef</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://tecracer-chef.github.io/2023/03/arm-your-github-actions-runners-using-aws-graviton.html><meta http-equiv=content-language content="en-us"><meta property="og:type" content="website"><meta property="og:site_name" content="tecRacer Chef"><meta property="og:title" content="Arm your GitHub Actions Runners using AWS Graviton"><meta property="og:url" content="https://tecracer-chef.github.io/2023/03/arm-your-github-actions-runners-using-aws-graviton.html"><meta property="og:image" content="https://tecracer-chef.github.io/images/"><meta name=twitter:title content="tecRacer Chef"><meta name=twitter:url content="https://tecracer-chef.github.io/2023/03/arm-your-github-actions-runners-using-aws-graviton.html"><meta name=twitter:image content="https://tecracer-chef.github.io/images/"><meta name=twitter:card content><link rel=alternate href=/blog/feed title="Patrick Schaumburg" type=application/rss+xml><link href=https://tecracer-chef.github.io/css/theme.css rel=stylesheet><script src=https://tecracer-chef.github.io/js/jquery.min.js></script>
<script src=https://tecracer-chef.github.io/js/uikit.min.js></script>
<script src=https://tecracer-chef.github.io/js/fa-all.js></script></head><body><div class="uk-container uk-container-center"><div class=tm-header><div class="tm-toolbar uk-clearfix uk-hidden-small"><div class=uk-float-right><div class=uk-panel><ul class=uk-subnav><li><a href=https://github.com/tecracer-chef class="uk-icon-hover uk-icon-small uk-icon-github" target=_blank></a></li><li><a href=https://twitter.com/tecracer class="uk-icon-hover uk-icon-small uk-icon-twitter" target=_blank></a></li><li><a href=https://www.xing.com/companies/tecracergmbh%26co.kg class="uk-icon-hover uk-icon-small uk-icon-xing" target=_blank></a></li><li><a href=https://www.linkedin.com/company/tecracer-group/ class="uk-icon-hover uk-icon-small uk-icon-linkedin" target=_blank></a></li><li><a href=https://www.facebook.com/tecRacer class="uk-icon-hover uk-icon-small uk-icon-facebook" target=_blank></a></li></ul></div></div></div><nav class=uk-navbar><a class=uk-navbar-brand href=/><img class="tm-logo uk-responsive-height uk-hidden-small" src=https://tecracer-chef.github.io/img/logo/logo-tr.png alt>
<img class="tm-logo-small uk-responsive-height uk-visible-small" src=https://tecracer-chef.github.io/img/logo/logo-tr.png alt></a><div class=uk-hidden-small><ul class=uk-navbar-nav><li><a href=/ title>Blog</a></li><li><a href=/authors title>Authors</a></li><li><a href=/github/github-prs.html title>Pull Requests</a></li></ul></div><div class="uk-navbar-flip uk-visible-small"><a href=#offcanvas class=uk-navbar-toggle data-uk-offcanvas></a></div></nav></div><div id=content><main id=tm-content class=tm-content><article class=uk-article><div class="tm-article-featured-image uk-cover-background" style=background-image:url(img/2023/03/17126279_athlete_closeup__runner__arm_concept_art__matte_painting__HQ__4k.png)></div><div class="tm-article-content uk-position-relative"><div class="tm-article-date uk-text-center"><span class=tm-article-date-day>14</span>
<span class=tm-article-date-month>Mar</span></div><h1 class=uk-article-title>Arm your GitHub Actions Runners using AWS Graviton</h1><p class=uk-article-meta>Written by
<a target=_self title="Patrick Schaumburg's Author Profile SINGLE.HTML" href=/authors/patrick-schaumburg data-original-title="Author's Profile">Patrick Schaumburg</a></p><div class=uk-margin><p>GitHub does not support any ARM GitHub Actions Runners. So what now?
Build it within your AWS environment!</p><p>The results are pretty cool: You have full control over the Runners and have no more time constraints like long-running workflows that consume Runners usage minutes.</p><p>I will guide you through the basics of creating an AWS EC2 instance and installing the minimum requirements on the OS for having a running GitHub Actions Runner.</p><h2 id=aws-ec2-creation>AWS EC2 creation</h2><p>First of all, we need something to work with. In my case, I already have a default VPC created with two public and two private subnets. Both private subnets have a single NAT Gateway for the outgoing internet connection required for fetching new action jobs of the GitHub Actions runner.</p><p><img src=/img/2023/03/arm-github-runner-vpc-simple.jpeg alt="VPC 2x2"></p><p>When you have established your work environment, we are looking into creating an EC2 instance. Please open the EC2 web interface and click <code>Launch Instances</code>.</p><p>The now-mentioned settings are the minimum required to have your EC2 instance running correctly, including the administrative parts within the OS itself.</p><ol><li>Add a Name for your EC2 instance: <code>GitHub Actions Runner</code></li><li>Choose the AMI you want to use: Quickstart - <code>Ubuntu 22.04 LTS</code></li><li>Change the Architecture to <code>64-bit (Arm)</code></li><li>Choose an AWS Graviton instance: <code>t4g.small</code> (the g stands for Graviton instances)</li><li>Choose <code>Proceed without a key pair</code> (we are using the AWS Session Manager)</li><li>Click on <code>Edit</code> in the Network Setting area<ol><li>Choose your VPC and use a private subnet</li><li>Create a new Security Group with no inbound rules (remove the suggested one)</li></ol></li><li>Decide about the volume storage (I am mostly choosing 50/100 GB for this)</li><li>Expand <code>Advanced details</code> and add an <code>IAM instance profile</code> that has at least the <code>AmazonSSMManagedInstanceCore</code> managed policy attached</li><li>Click on <code>Launch instance</code></li></ol><p>When you do the steps described, you have done nearly everything to have your own GitHub Actions Runner. The only thing that needs to be done now is to download, extract, configure, and run the runner application.</p><h2 id=configure-and-register-with-github>Configure and register with GitHub</h2><p>As we have prepared our EC2 instance with the basic settings within AWS, we are looking into the steps for the runner application itself.</p><p>To do so, connect yourself to your EC2 instance with the help of the AWS Session Manager.</p><ol><li>Go to EC2 and choose your instance</li><li>Click on <code>Connect</code></li><li>Choose <code>Session Manager</code> and click again on <code>Connect</code> (when the button is not available, you might have forgotten to add your instance profile to your EC2 instance that allows this)</li><li>Type in <code>sudo -i -u ubuntu</code> to switch to the default ubuntu user</li></ol><p>In a new window in your browser, you have to open up your GitHub Organization Settings.</p><ol><li>In Settings, go to <code>Actions > Runners</code> and click on <code>New Runner</code></li><li>Choose <code>Linux</code> and <code>ARM64</code> as the Architecture</li><li>Follow the mentioned steps (you can easily copy each line). Each instruction line should be executed within your AWS Session Manager Session in your other window.<ol><li>Create the working directory</li><li>Download the runner application and extract it</li><li>Configure the runner application (When running the <code>./config.sh --URL https://github.com/tecracer --token TECRACER</code> you should initially accept all settings proposed to you. So only press enter until the GitHub Actions Runner is configured.)</li></ol></li><li>Finally, execute <code>./run.sh</code> to start your own GitHub Action Runner</li></ol><p>This is the last and final configuration step in this blog article to have the Actions Runner available. It is now present within the same menu, <code>Organization Settings > Actions > Runners</code> and should be available for you.
You can now install your packages like ruby, dev tools, docker, etc., to use it.</p><p><img src=/img/2023/03/arm-github-runner-gh-org.jpg alt="GitHub Organization Action Runner"></p><p>As said, this is only the general configuration. There are more things you should consider to do.
Below is some additional content to have at least an idea about things you should consider.
I have also added some advantages and disadvantages below.</p><p>Have fun testing this out and saving money!</p><h2 id=things-to-consider>Things to consider</h2><p>Based on the experience with different software, environments, and customers, it is always good to think a bit about the following:</p><ul><li>using a different user than the default user</li><li>having a hardened OS</li><li>add more security measurements like antivirus, antimalware, etc.</li><li>Use systemd to run <code>./run.sh</code> script</li></ul><p>As we have spoken now about only a single GitHub Actions Runner, which is manually created and configured, think about this:</p><ul><li>Use Terraform to create the infrastructure</li><li>Use Configuration Management tools like Chef for installing and configuring the required software and more</li><li>Use AWS Spot Instances for spending less than having an always-on EC2 instance</li></ul><p>Check out <a href=https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners>GitHub Docs</a></p><h2 id=advantages-and-disadvantages>Advantages and Disadvantages?</h2><p>Of course, using a self-hosted GitHub Actions runner always has both. I have created a list to give you at least a short idea of what is good and what is not so good.</p><h3 id=advantages>Advantages</h3><ul><li>choose your own OS, installed software, and manage it in your environment</li><li>decide how performant your runner should be</li><li>no dependency on monthly runner minutes</li></ul><h3 id=disadvantages>Disadvantages</h3><ul><li>Patching needs to be done on your own</li><li>re-using the same runner again without cleanup per default</li></ul><h3 id=advantagesdisadvantages-based-on-your-work-within-github>Advantages/Disadvantages (based on your work within GitHub)</h3><ul><li>only possible for private repositories</li></ul><p>— Patrick</p></div></div></article><article class=uk-article><div class=container><section class=author-box itemprop=author itemscope itemtype=https://schema.org/Person><div class="media author-box"><div class=media-figure><img alt="Author Image" src=/authors/pschaumburg.jpg class="avatar avatar-100 photo" height=125 width=125></div><div class=media-body><h2><a href=/authors/patrick-schaumburg>Patrick Schaumburg</a></h2><p>Patrick is Cloud Consultant and Trainer at tecRacer Consulting with a focus on Chef, AWS and DevOps.</p><div class=author-icons><a target=_self class=author-website title="Patrick Schaumburg's Author Profile" href=/authors/patrick-schaumburg data-original-title="Author's Profile"><i class="fas fa-id-card"></i></a>
<a target=_new class=author-xing title="Patrick Schaumburg on Xing" href=https://xing.com/profile/Patrick_Schaumburg2 data-original-title=Xing><i class="fab fa-xing"></i></a>
<a target=_new class=author-linkedin title="Patrick Schaumburg on LinkedIn" href=https://linkedin.com/in/patrick-schaumburg-600622ab data-original-title=LinkdIn><i class="fab fa-linkedin"></i></a>
<a target=_new class=author-github title="Patrick Schaumburg on GitHub" href=https://github.com/pschaumburg data-original-title=Github><i class="fab fa-github"></i></a></div></div></div></section></div></article></main></div><div id=tm-footer class=tm-footer><div id=tm-footer class="tm-footer tm-footer-margin-top"><div class="uk-panel uk-panel-space uk-text-center"><p>Copyright © 2018-today by <a href=https://chef.tecracer.de/ target=_blank>tecRacer</a></p></div></div></div><div id=offcanvas class=uk-offcanvas aria-hidden=true><div class="uk-offcanvas-bar uk-offcanvas-bar-flip"><div class="uk-panel uk-text-center"><a href=https://tecracer-chef.github.io/></a>
<img src=https://tecracer-chef.github.io/img/logo/logo-tr.png alt></a></div><ul class="uk-nav uk-nav-offcanvas"><li><a href=/ title>Blog</a></li><li><a href=/authors title>Authors</a></li><li><a href=/github/github-prs.html title>Pull Requests</a></li></ul></div></div></div></body></html>